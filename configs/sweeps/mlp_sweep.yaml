# Wandb Sweep Configuration for MLP Model
# Usage: python scripts/run_sweep.py --config configs/sweeps/mlp_sweep.yaml

program: scripts/train.py
method: bayes  # bayes, random, or grid
metric:
  name: val_acc
  goal: maximize

parameters:
  # Base config to use
  config:
    value: configs/mlp.yaml
  
  # Enable wandb for sweep runs
  wandb:
    value: true

  # Learning rate (log-uniform distribution)
  lr:
    distribution: log_uniform_values
    min: 0.00001
    max: 0.01
  
  # Batch size (categorical)
  batch_size:
    values: [16, 32, 64, 128]
  
  # Dropout rate (uniform distribution)
  dropout_rate:
    distribution: uniform
    min: 0.1
    max: 0.5
  
  # Hidden layer dimensions (categorical)
  hidden_dims:
    values:
      - [128, 64]
      - [256, 128]
      - [512, 256]
      - [256, 128, 64]
      - [512, 256, 128]
  
  # Weight decay (log-uniform)
  weight_decay:
    distribution: log_uniform_values
    min: 0.00001
    max: 0.01

  # Optimizer choice
  optimizer:
    values: [adam, adamw]

  # Label smoothing
  label_smoothing:
    distribution: uniform
    min: 0.0
    max: 0.2

# Early termination for poorly performing runs
early_terminate:
  type: hyperband
  min_iter: 5
  eta: 3
  s: 2

# Run settings
run_cap: 50  # Maximum number of runs

